<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bolt Media Tool</title>
<style>
    /* Reset */
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(to right, #f5f7fa, #c3cfe2);
        padding: 40px;
        min-height: 100vh;
    }

    .container {
        max-width: 800px;
        margin: auto;
        background: #ffffff;
        padding: 30px;
        border-radius: 16px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
    }
    .container:hover { transform: translateY(-5px); }

    h2 {
        color: #333;
        margin-bottom: 10px;
        font-size: 28px;
        text-align: center;
    }
    p { color: #555; text-align: center; margin-bottom: 25px; font-size: 16px; }

    label { font-weight: 600; color: #444; display: block; margin-bottom: 8px; }
    input[type="file"], select {
        width: 100%;
        padding: 12px;
        border-radius: 10px;
        border: 1px solid #ccc;
        margin-bottom: 15px;
        transition: border 0.3s;
    }
    input[type="file"]:focus, select:focus { border-color: #007bff; outline: none; }

    button {
        padding: 14px;
        width: 100%;
        border: none;
        border-radius: 10px;
        background: linear-gradient(90deg, #4facfe, #00f2fe);
        color: white;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        transition: transform 0.2s, box-shadow 0.2s;
    }
    button:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(0,0,0,0.15);
    }

    /* Progress Bar */
    .progress {
        width: 100%;
        background: #eee;
        height: 16px;
        border-radius: 10px;
        margin-top: 20px;
        display: none;
        overflow: hidden;
    }
    .progress-bar {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #4facfe, #00f2fe);
        transition: width 0.3s ease;
    }

    /* Side-by-side preview */
    .preview-box {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
        gap: 20px;
        flex-wrap: wrap;
    }
    .preview {
        flex: 1 1 48%;
        background: #f9f9f9;
        padding: 15px;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 8px 20px rgba(0,0,0,0.05);
        transition: transform 0.3s;
    }
    .preview:hover { transform: translateY(-3px); }
    .preview h3 { margin-bottom: 10px; color: #555; }
    .preview img {
        width: 100%;
        border-radius: 12px;
        display: none;
        box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    }

    /* Download button */
    #download-btn {
        display: none;
        margin-top: 20px;
        text-align: center;
        text-decoration: none;
        font-weight: bold;
        font-size: 16px;
        padding: 14px;
        border-radius: 10px;
        background: linear-gradient(90deg, #43e97b, #38f9d7);
        color: #fff;
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        transition: transform 0.2s, box-shadow 0.2s;
    }
    #download-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 25px rgba(0,0,0,0.15); }
</style>
</head>
<body>

<div class="container">
    <h2>âš¡ Bolt Media Tool</h2>
    <p>Remove background, enhance quality & add a professional clean background.</p>

    <form id="uploadForm">
        <label>Upload Product Image:</label>
        <input type="file" name="image" id="imageInput" required>

        <label>Choose Background Color:</label>
        <select name="bg_color" id="bgSelect">
            <option value="">Transparent</option>
            <option value="White">White</option>
            <option value="Light Gray">Light Gray</option>
            <option value="Soft Blue">Soft Blue</option>
            <option value="Beige">Beige</option>
        </select>

        <button type="submit">Process Image</button>
    </form>

    <div class="progress" id="progress">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <div class="preview-box">
        <div class="preview">
            <h3>Before</h3>
            <img id="before-img">
        </div>
        <div class="preview">
            <h3>After</h3>
            <img id="result-img">
        </div>
    </div>

    <a id="download-btn" download="processed.png">Download Processed Image</a>
</div>

<script>
document.getElementById("imageInput").onchange = function(event) {
    let file = event.target.files[0];
    let beforeImg = document.getElementById("before-img");
    beforeImg.src = URL.createObjectURL(file);
    beforeImg.style.display = "block";
};

document.getElementById("uploadForm").onsubmit = async function(e) {
    e.preventDefault();

    const formData = new FormData();
    formData.append("image", document.getElementById("imageInput").files[0]);
    formData.append("bg_color", document.getElementById("bgSelect").value);

    let progress = document.getElementById("progress");
    let bar = document.getElementById("progress-bar");
    progress.style.display = "block";
    bar.style.width = "10%";

    let interval = setInterval(() => {
        let w = parseInt(bar.style.width);
        if (w < 90) bar.style.width = (w + 10) + "%";
    }, 300);

    try {
        const response = await fetch("/process", { method: "POST", body: formData });
        const data = await response.json();
        clearInterval(interval);
        bar.style.width = "100%";

        if (data.image) {
            let resultImg = document.getElementById("result-img");
            resultImg.src = "data:image/png;base64," + data.image;
            resultImg.style.display = "block";

            let downloadBtn = document.getElementById("download-btn");
            downloadBtn.href = resultImg.src;
            downloadBtn.style.display = "block";
        }
    } catch (err) {
        alert("Error processing image: " + err);
    }

    setTimeout(() => {
        progress.style.display = "none";
        bar.style.width = "0%";
    }, 500);
};
</script>

</body>
</html>
